using System;
using System.Collections;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;
using SystemMaker;
using FluentAssertions;
using Xunit;

namespace VDFTests
{
	public class Quick
	{
		// temp
		// ==========

		[VDFType(true, true)] public class FrameData
		{
			public FrameSettings settings = new FrameSettings();
			public Dictionary<string, object> prefs = new Dictionary<string, object>();
			public string liveWorldName;

			// designer
			public string lastLivePackName;
		}
		public enum ShadowType
		{
			None,
			Hard,
			Soft
		}

		[VDFType(true, true)] public class FrameSettings
		{
			public bool showTooltips = true;
			public List<string> autoOpenSubmenus = new List<string> {"Frame2", "CreativeDefense"};
			public string autoOpenPage = "";
		}

		[Fact] void Load()
		{
			var a = VDFLoader.ToVDFNode(@"{

	'urlBaseType': 'relativeToScene',

	'metadata': {
		'formatVersion' : 3.2,
		'type'          : 'scene',
		'sourceFile'    : 'Main.blend',
		'generatedBy'   : 'Blender 2.7 Exporter',
		'objects'       : 4,
		'geometries'    : 4,
		'materials'     : 2,
		'textures'      : 0
	},

	'objects': {
		'Root': {
			'geometry'      : 'geo_Root',
			'groups'        : [  ],
			'material'      : '',
			'position'      : [ 0.0995207, 0.100025, -0.402235 ],
			'rotation'      : [ -1.5708, 0, 0 ],
			'quaternion'    : [ -0.707107, 0, 0, 0.707107 ],
			'scale'         : [ 1, 1, 1 ],
			'visible'       : true,
			'castShadow'    : false,
			'receiveShadow' : false,
			'doubleSided'   : false
		},
		'Back': {
			'geometry'      : 'geo_Root.003',
			'groups'        : [  ],
			'material'      : 'Base',
			'position'      : [ 0.0995207, 0.100025, -0.00466826 ],
			'rotation'      : [ -1.5708, 0, 0 ],
			'quaternion'    : [ -0.707107, 0, 0, 0.707107 ],
			'scale'         : [ 1, 1, 1 ],
			'visible'       : true,
			'castShadow'    : false,
			'receiveShadow' : false,
			'doubleSided'   : false
		},
		'Head': {
			'geometry'      : 'geo_Root.002',
			'groups'        : [  ],
			'material'      : 'Back',
			'position'      : [ 0.0995207, 0.100025, -0.799801 ],
			'rotation'      : [ -1.5708, 0, 0 ],
			'quaternion'    : [ -0.707107, 0, 0, 0.707107 ],
			'scale'         : [ 1, 0.6, 1 ],
			'visible'       : true,
			'castShadow'    : false,
			'receiveShadow' : false,
			'doubleSided'   : false
		},
		'Base': {
			'geometry'      : 'geo_Root.001',
			'groups'        : [  ],
			'material'      : 'Base',
			'position'      : [ 0.0995207, 0.100025, -0.299668 ],
			'rotation'      : [ -1.5708, 0, 0 ],
			'quaternion'    : [ -0.707107, 0, 0, 0.707107 ],
			'scale'         : [ 1, 1, 1 ],
			'visible'       : true,
			'castShadow'    : false,
			'receiveShadow' : false,
			'doubleSided'   : false
		}
	},

	'geometries': {
		'geo_Root': {
			'type' : 'embedded',
			'id'   : 'emb_Root'
		},
		'geo_Root.003': {
			'type' : 'embedded',
			'id'   : 'emb_Root.003'
		},
		'geo_Root.002': {
			'type' : 'embedded',
			'id'   : 'emb_Root.002'
		},
		'geo_Root.001': {
			'type' : 'embedded',
			'id'   : 'emb_Root.001'
		}
	},

	'materials': {
		'Back': {
			'type'       : 'MeshLambertMaterial',
			'parameters' : { 'color': 2301970, 'ambient': 2301970, 'emissive': 0, 'opacity': 1, 'blending': 'NormalBlending' }
		},
		'Base': {
			'type'       : 'MeshLambertMaterial',
			'parameters' : { 'color': 3288595, 'ambient': 3288595, 'emissive': 0, 'opacity': 1, 'blending': 'NormalBlending' }
		}
	},

	'embeds': {
		'emb_Root.003': {
			'scale' : 1.000000,
			
			'vertices' : [-1.49012e-08,0.00600002,0.11,-1.49012e-08,-0.00600002,0.11,0.0777817,0.00600002,0.0777818,0.0777817,-0.00600002,0.0777817,0.11,0.00600002,-7.45058e-09,0.11,-0.00600002,-7.45058e-09,0.0777817,0.00600002,-0.0777817,0.0777817,-0.00600002,-0.0777818,-1.49012e-08,0.00600002,-0.11,-1.49012e-08,-0.00600002,-0.11,-0.0777818,0.00600002,-0.0777817,-0.0777818,-0.00600002,-0.0777817,-0.11,0.00600002,-7.45058e-09,-0.11,-0.00600002,-7.45058e-09,-0.0777818,0.00600002,0.0777817,-0.0777818,-0.00600002,0.0777817],
			'faces'    : [43,0,1,3,2,0,0,1,2,3,0,1,2,3,43,2,3,5,4,0,3,2,4,5,3,2,4,5,43,4,5,7,6,0,5,4,6,7,5,4,6,7,43,6,7,9,8,0,8,9,10,11,7,6,8,9,43,8,9,11,10,0,11,10,12,13,9,8,10,11,43,10,11,13,12,0,14,15,16,17,11,10,12,13,42,3,7,5,0,18,19,20,2,6,4,42,3,1,15,0,18,21,22,2,1,14,42,15,13,11,0,22,23,24,14,12,10,42,11,9,7,0,24,25,19,10,8,6,42,3,15,7,0,18,22,19,2,14,6,42,15,11,7,0,22,24,19,14,10,6,43,1,0,14,15,0,26,27,28,29,1,0,15,14,43,12,13,15,14,0,17,16,29,28,13,12,14,15,42,0,12,14,0,30,31,32,0,13,15,42,0,2,4,0,30,33,34,0,3,5,42,4,6,8,0,34,35,36,5,7,9,42,8,10,12,0,36,37,31,9,11,13,42,0,4,12,0,30,34,31,0,5,13,42,4,8,12,0,34,36,31,5,9,13],
			'uvs'      : [[0.502068,0.522727,0.511261,0.522727,0.511261,0.567827,0.502068,0.567827,0.511261,0.631608,0.502068,0.631608,0.511261,0.676707,0.502068,0.676707,0.296331,0.687528,0.287137,0.687528,0.287137,0.642428,0.29633,0.642428,0.287137,0.578648,0.296331,0.578648,0.342299,0.578648,0.351493,0.578648,0.351493,0.623747,0.342299,0.623747,0.022984,0.687528,0.133095,0.732628,0.068594,0.732628,0.022984,0.623747,0.068594,0.578648,0.133096,0.578648,0.178705,0.623748,0.178705,0.687528,0.351493,0.732628,0.342299,0.732628,0.342299,0.687528,0.351493,0.687528,0.584994,0.68731,0.695105,0.732409,0.630604,0.732409,0.584994,0.623529,0.630604,0.578429,0.695105,0.578429,0.740715,0.623529,0.740715,0.68731]],
			'normals'  : [0,0.630238,0.77636,0,-0.630238,0.77636,0.548967,-0.630238,0.548967,0.548967,0.630238,0.548967,0.77636,-0.630238,0,0.77636,0.630238,0,0.548967,-0.630238,-0.548967,0.548967,0.630238,-0.548967,0,-0.630238,-0.77636,0,0.630238,-0.77636,-0.548967,-0.630238,-0.548967,-0.548967,0.630238,-0.548967,-0.77636,-0.630238,0,-0.77636,0.630238,0,-0.548967,-0.630238,0.548967,-0.548967,0.630238,0.548967],
			
			'skinIndices'  : [],
			'skinWeights'  : [],
			'morphTargets' : [],
			
			'bones'      : [],
			'animations' : [],
			
			'colors'    : [],
			'materials' : [
				{
					'DbgColor': 15658734,
					'DbgIndex': 0,
					'DbgName': 'Base',
					'blending': 'NormalBlending',
					'colorAmbient': [0.19695519502394188, 0.1817016509428866, 0.07565109842495765],
					'colorDiffuse': [0.19695519502394188, 0.1817016509428866, 0.07565109842495765],
					'colorEmissive': [0.0, 0.0, 0.0],
					'colorSpecular': [0.5, 0.5, 0.5],
					'depthTest': true,
					'depthWrite': true,
					'shading': 'Lambert',
					'specularCoef': 50,
					'transparency': 1.0,
					'transparent': false,
					'vertexColors': false
				}
			]
		},
		'emb_Root.001': {
			'scale' : 1.000000,
			
			'vertices' : [-1.49012e-08,0.3,0.1,-1.49012e-08,-0.3,0.1,0.0707106,0.3,0.0707107,0.0707106,-0.3,0.0707107,0.1,0.3,-7.45058e-09,0.1,-0.3,-7.45058e-09,0.0707106,0.3,-0.0707107,0.0707106,-0.3,-0.0707107,-1.49012e-08,0.3,-0.1,-1.49012e-08,-0.3,-0.1,-0.0707107,0.3,-0.0707107,-0.0707107,-0.3,-0.0707107,-0.1,0.3,-7.45058e-09,-0.1,-0.3,-7.45058e-09,-0.0707107,0.3,0.0707107,-0.0707107,-0.3,0.0707107],
			'faces'    : [43,0,1,3,2,0,0,1,2,3,0,1,2,3,43,2,3,5,4,0,3,2,4,5,3,2,4,5,43,4,5,7,6,0,6,7,8,9,5,4,6,7,43,6,7,9,8,0,9,8,10,11,7,6,8,9,43,8,9,11,10,0,12,13,14,15,9,8,10,11,43,10,11,13,12,0,15,14,16,17,11,10,12,13,42,3,7,5,0,18,19,20,2,6,4,42,3,1,15,0,18,21,22,2,1,14,42,15,13,11,0,22,23,24,14,12,10,42,11,9,7,0,24,25,19,10,8,6,42,3,15,7,0,18,22,19,2,14,6,42,15,11,7,0,22,24,19,14,10,6,43,1,0,14,15,0,26,27,28,29,1,0,15,14,43,12,13,15,14,0,17,16,30,31,13,12,14,15,42,0,12,14,0,32,33,34,0,13,15,42,0,2,4,0,32,35,36,0,3,5,42,4,6,8,0,36,37,38,5,7,9,42,8,10,12,0,38,39,33,9,11,13,42,0,4,12,0,32,36,33,0,5,13,42,4,8,12,0,36,38,33,5,9,13],
			'uvs'      : [[0.730845,0.477273,0.730845,0.022727,0.772308,0.022727,0.772308,0.477273,0.830946,0.022727,0.830946,0.477273,0.876915,0.477273,0.876915,0.022727,0.918378,0.022727,0.918378,0.477273,0.977016,0.022727,0.977016,0.477273,0.539026,0.022727,0.539025,0.477273,0.497562,0.477273,0.497562,0.022727,0.438924,0.477273,0.438924,0.022727,0.914091,0.818864,0.81399,0.777864,0.872628,0.777864,0.914091,0.876846,0.872628,0.917846,0.81399,0.917846,0.772527,0.876846,0.772527,0.818864,0.397461,0.977273,0.397461,0.522727,0.456099,0.522727,0.456099,0.977273,0.397461,0.477273,0.397461,0.022727,0.886784,0.578429,0.786683,0.619429,0.828146,0.578429,0.928248,0.619429,0.928248,0.677411,0.886784,0.718411,0.828146,0.718411,0.786683,0.677411]],
			'normals'  : [0,0.630238,0.77636,0,-0.630238,0.77636,0.548967,-0.630238,0.548967,0.548967,0.630238,0.548967,0.77636,-0.630238,0,0.77636,0.630238,0,0.548967,-0.630238,-0.548967,0.548967,0.630238,-0.548967,0,-0.630238,-0.77636,0,0.630238,-0.77636,-0.548967,-0.630238,-0.548967,-0.548967,0.630238,-0.548967,-0.77636,-0.630238,0,-0.77636,0.630238,0,-0.548967,-0.630238,0.548967,-0.548967,0.630238,0.548967],
			
			'skinIndices'  : [],
			'skinWeights'  : [],
			'morphTargets' : [],
			
			'bones'      : [],
			'animations' : [],
			
			'colors'    : [],
			'materials' : [
				{
					'DbgColor': 15658734,
					'DbgIndex': 0,
					'DbgName': 'Base',
					'blending': 'NormalBlending',
					'colorAmbient': [0.19695519502394188, 0.1817016509428866, 0.07565109842495765],
					'colorDiffuse': [0.19695519502394188, 0.1817016509428866, 0.07565109842495765],
					'colorEmissive': [0.0, 0.0, 0.0],
					'colorSpecular': [0.5, 0.5, 0.5],
					'depthTest': true,
					'depthWrite': true,
					'shading': 'Lambert',
					'specularCoef': 50,
					'transparency': 1.0,
					'transparent': false,
					'vertexColors': false
				}
			]
		},
		'emb_Root': {
			'scale' : 1.000000,
			
			'vertices' : [],
			'faces'    : [],
			'uvs'      : [],
			'normals'  : [],
			
			'skinIndices'  : [],
			'skinWeights'  : [],
			'morphTargets' : [],
			
			'bones'      : [],
			'animations' : [],
			
			'colors'    : [],
			'materials' : [
				{
					'DbgColor': 15658734,
					'DbgIndex': 0,
					'DbgName': 'undefined_dummy_0',
					'vertexColors': false
				}
			]
		},
		'emb_Root.002': {
			'scale' : 1.000000,
			
			'vertices' : [-7.45058e-09,0.1,0.0700001,-1.49012e-08,-0.333333,0.1,0.0494975,0.1,0.0494975,0.0707106,-0.333333,0.0707107,0.07,0.1,2.98023e-08,0.1,-0.333333,2.23517e-08,0.0494975,0.1,-0.0494974,0.0707106,-0.333333,-0.0707107,-7.45058e-09,0.1,-0.0699999,-1.49012e-08,-0.333333,-0.1,-0.0494975,0.1,-0.0494974,-0.0707107,-0.333333,-0.0707106,-0.07,0.1,2.98023e-08,-0.1,-0.333333,2.23517e-08,-0.0494975,0.1,0.0494975,-0.0707107,-0.333333,0.0707107,0,0.333333,4.47035e-08],
			'faces'    : [43,0,1,3,2,0,0,1,2,3,0,1,2,3,43,2,3,5,4,0,3,2,4,5,3,2,4,5,43,4,5,7,6,0,5,4,6,7,5,4,6,7,43,6,7,9,8,0,8,9,10,11,7,6,8,9,43,8,9,11,10,0,11,10,12,13,9,8,10,11,43,10,11,13,12,0,14,15,16,17,11,10,12,13,42,3,7,5,0,18,19,20,2,6,4,42,3,1,15,0,18,21,22,2,1,14,42,15,13,11,0,22,23,24,14,12,10,42,11,9,7,0,24,25,19,10,8,6,42,3,15,7,0,18,22,19,2,14,6,42,15,11,7,0,22,24,19,14,10,6,43,1,0,14,15,0,26,27,28,29,1,0,15,14,43,12,13,15,14,0,17,16,29,28,13,12,14,15,42,14,0,16,0,28,27,30,15,0,16,42,12,14,16,0,17,28,30,13,15,16,42,10,12,16,0,14,17,30,11,13,16,42,8,10,16,0,11,13,31,9,11,16,42,6,8,16,0,8,11,31,7,9,16,42,4,6,16,0,5,7,32,5,7,16,42,2,4,16,0,3,5,32,3,5,16,42,0,2,16,0,0,3,32,0,3,16],
			'uvs'      : [[0.252604,0.359039,0.210223,0.035911,0.251155,0.026464,0.281257,0.352426,0.309671,0.022727,0.322218,0.34981,0.351493,0.02689,0.351493,0.352724,0.614959,0.356658,0.584994,0.032174,0.626259,0.024268,0.643844,0.351124,0.684877,0.022727,0.684877,0.350046,0.164254,0.203196,0.164254,0.529031,0.122433,0.533193,0.134979,0.20611,0.626457,0.917846,0.726558,0.876846,0.685095,0.917846,0.584994,0.876846,0.584994,0.818864,0.626457,0.777864,0.685095,0.777864,0.726558,0.818864,0.022984,0.52001,0.065365,0.196882,0.094018,0.203494,0.063917,0.529457,0.126389,0.022727,0.669263,0.532975,0.313628,0.533193]],
			'normals'  : [0,0.174718,0.984588,0,-0.604144,0.796869,0.563463,-0.604144,0.563463,0.696219,0.174718,0.696219,0.796869,-0.604144,0,0.984588,0.174718,0,0.563463,-0.604144,-0.563463,0.696219,0.174718,-0.696219,0,-0.604144,-0.796869,0,0.174718,-0.984588,-0.563463,-0.604144,-0.563463,-0.696219,0.174718,-0.696219,-0.796869,-0.604144,0,-0.984588,0.174718,0,-0.563463,-0.604144,0.563463,-0.696219,0.174718,0.696219,0,1,0],
			
			'skinIndices'  : [],
			'skinWeights'  : [],
			'morphTargets' : [],
			
			'bones'      : [],
			'animations' : [],
			
			'colors'    : [],
			'materials' : [
				{
					'DbgColor': 15658734,
					'DbgIndex': 0,
					'DbgName': 'Back',
					'blending': 'NormalBlending',
					'colorAmbient': [0.13868376223271728, 0.12796322297995122, 0.07443034759805123],
					'colorDiffuse': [0.13868376223271728, 0.12796322297995122, 0.07443034759805123],
					'colorEmissive': [0.0, 0.0, 0.0],
					'colorSpecular': [0.5, 0.5, 0.5],
					'depthTest': true,
					'depthWrite': true,
					'shading': 'Lambert',
					'specularCoef': 50,
					'transparency': 1.0,
					'transparent': false,
					'vertexColors': false
				}
			]
		}
	},

	'transform': {
		'position' : [ 0, 0, 0 ],
		'rotation' : [ 0, 0, 0 ],
		'scale'    : [ 1, 1, 1 ]
	},

	'defaults': {
		'bgcolor' : [ 0, 0, 0 ],
		'bgalpha' : 1.000000,
		'camera'  : ''
	}

}
", new VDFLoadOptions().ForJSON());
			a["embeds"]["emb_Root"]["materials"].listChildren.Count.Should().Be(1);
		}

		/*[Fact] void Save()
		{
			var a = VDF.Deserialize<FrameData>(@"
	settings{showTooltips{true}autoOpenSubmenus{Frame2|CreativeDefense}autoOpenPage{>empty}}
	prefs{Types_toolOptions{@@Select{}Add{}Resize{}Remove{}@@}Types_liveTool{Select}}
	liveWorldName{>null}
	lastLivePackName{>null}", new VDFLoadOptions(null, null, new Dictionary<Type, string>
			{
				{typeof(Vector3), "Vector3"}
			}));
			VDF.Serialize<FrameData>(a).Should().Be(@"
	settings:
		showTooltips{true}
		autoOpenSubmenus{Frame2|CreativeDefense}
		autoOpenPage{>empty}
	prefs{Types_toolOptions{@@Select{}Add{}Resize{}Remove{}@@}Types_liveTool{Select}}
	liveWorldName{>null}
	lastLivePackName{>null}".Replace("\r\n", "\n"));
		}*/
	}
}

class Vector3 {}